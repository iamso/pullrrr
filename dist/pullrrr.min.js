/*!
 * pullrrr - version 0.2.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2018 Steve Ottoz
 */
(function(a,b){if('function'==typeof define&&define.amd)define(['module','exports'],b);else if('undefined'!=typeof exports)b(module,exports);else{var c={exports:{}};b(c,c.exports),a.Pullrrr=c.exports}})(this,function(a,b){'use strict';function c(a,b){if(!(a instanceof b))throw new TypeError('Cannot call a class as a function')}Object.defineProperty(b,'__esModule',{value:!0});var d='function'==typeof Symbol&&'symbol'==typeof Symbol.iterator?function(a){return typeof a}:function(a){return a&&'function'==typeof Symbol&&a.constructor===Symbol&&a!==Symbol.prototype?'symbol':typeof a},e=function(){function a(a,b){for(var c,d=0;d<b.length;d++)c=b[d],c.enumerable=c.enumerable||!1,c.configurable=!0,'value'in c&&(c.writable=!0),Object.defineProperty(a,c.key,c)}return function(b,c,d){return c&&a(b.prototype,c),d&&a(b,d),b}}(),f=document.body,g=document.documentElement,h=document.head,i={threshold:100,max:150,prefix:'pullrrr',over:!1,fade:!1,maxWidth:!1},j={passive:!1},k=!1;try{window.addEventListener('test',null,{get passive(){k=!0}})}catch(a){}var l=function(){function a(){var b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:{};c(this,a),this.options=Object.assign({},i,b),this.dragging=!1,this.startY=null,this.distance=null,this.abs=null,this.direction=null,this.executed=!1,this.callbacks={},this.classContainer=this.options.prefix+'-container',this.classPullTop=this.options.prefix+'-pull-top',this.classPullBottom=this.options.prefix+'-pull-bottom',this.classUseOver=this.options.prefix+'-use-over',this.classOver=this.options.prefix+'-over',this.classPulledDown=this.options.prefix+'-pulled-down',this.classPulledUp=this.options.prefix+'-pulled-up',this.classPullingDown=this.options.prefix+'-pulling-down',this.classPullingUp=this.options.prefix+'-pulling-up',this.classThreshold=this.options.prefix+'-threshold',this.classIsTop=this.options.prefix+'-is-top',this.classIsBottom=this.options.prefix+'-is-bottom',this.styles='\n    /**\n    * Required Pullrrr Styles\n    */\n    .'+this.options.prefix+'-container {\n      transition: 0.2s ease-out;\n    }\n    html.'+this.options.prefix+'-pulling-down .'+this.options.prefix+'-container,\n    html.'+this.options.prefix+'-is-top .'+this.options.prefix+'-container {\n      touch-action: pan-x pan-down pinch-zoom;\n    }\n    html.'+this.options.prefix+'-pulling-up .'+this.options.prefix+'-container,\n    html.'+this.options.prefix+'-is-bottom .'+this.options.prefix+'-container {\n      touch-action: pan-x pan-up pinch-zoom;\n    }\n    html.'+this.options.prefix+'-pulling-up .'+this.options.prefix+'-container,\n    html.'+this.options.prefix+'-pulling-down .'+this.options.prefix+'-container {\n      transition: 0s;\n    }',this.init()}return e(a,[{key:'init',value:function(){return this.style=document.createElement('style'),this.style.id=this.options.prefix+'-styles',this.style.textContent=this.options.maxWidth&&!isNaN(this.options.maxWidth)?'\n        @media (max-width: '+this.options.maxWidth+'px) {\n          '+this.styles+'\n        }\n      ':this.styles,h.appendChild(this.style),this.container=this.options.container instanceof Node?this.options.container:'string'==typeof this.options.container?document.querySelector(this.options.container):f,this.container.classList.add(this.classContainer),this.options.pullTop instanceof Node?this.pullTop=this.options.pullTop:'string'==typeof this.options.pullTop?this.pullTop=document.querySelector(this.options.pullTop):(this.pullTop=document.querySelector('.'+this.classPullTop),!this.pullTop&&(this.pullTop=document.createElement('div'),this.pullTop.classList.add(this.classPullTop),this.container.appendChild(this.pullTop))),this.options.pullBottom instanceof Node?this.pullBottom=this.options.pullBottom:'string'==typeof this.options.pullBottom?this.pullBottom=document.querySelector(this.options.pullBottom):(this.pullBottom=document.querySelector('.'+this.classPullBottom),!this.pullBottom&&(this.pullBottom=document.createElement('div'),this.pullBottom.classList.add(this.classPullBottom),this.container.appendChild(this.pullBottom))),this.options.over&&(g.classList.add(this.classUseOver),this.pullTop.classList.add(this.classOver),this.pullBottom.classList.add(this.classOver)),this.handlers={touchstart:this.touchstart.bind(this),touchmove:this.touchmove.bind(this),touchend:this.touchend.bind(this),scroll:this.scroll.bind(this)},window.addEventListener('touchstart',this.handlers.touchstart),window.addEventListener('touchmove',this.handlers.touchmove,!!k&&j),window.addEventListener('touchend',this.handlers.touchend),window.addEventListener('resize',this.handlers.scroll),this.container===f||this.container===g?window.addEventListener('scroll',this.handlers.scroll):this.container.addEventListener('scroll',this.handlers.scroll),this.scroll(),this}},{key:'on',value:function(a,b){return Array.isArray(this.callbacks[a])||(this.callbacks[a]=[]),this.callbacks[a].push(b),this}},{key:'resist',value:function(){var a=Math.min,b=0<arguments.length&&void 0!==arguments[0]?arguments[0]:0,c=a(1,b/this.options.threshold/2.5)*a(this.options.max,b);return b>this.options.max&&(c+=Math.max(0,(b-this.options.max)/6)),c}},{key:'isMaxWidth',value:function(){return this.options.maxWidth&&!isNaN(this.options.maxWidth)&&window.innerWidth>this.options.maxWidth}},{key:'touchstart',value:function(a){this.isMaxWidth()||this.canPull&&(g.classList.remove(this.classPulledUp),g.classList.remove(this.classPulledDown),this.dragging=!0,this.startY=a.touches[0].pageY)}},{key:'touchmove',value:function(a){if(!this.isMaxWidth()&&this.dragging){var b,c=a.touches[0].pageY-this.startY;if(this.direction=this.canPull,this.distance=this.resist(Math.abs(c)),this.abs=this.distance,0>c&&(this.distance=0-this.distance),('down'===this.direction||'both'===this.direction)&&0<c?(this.direction='down',b=this.pullTop):('up'===this.direction||'both'===this.direction)&&0>c?(this.direction='up',b=this.pullBottom):this.direction=!1,this.direction){if(a.preventDefault(),g.classList.add('down'===this.direction?this.classPullingDown:this.classPullingUp),b.style.height=this.abs+'px',this.options.fade&&(b.style.opacity=this.abs/this.options.threshold),this.options.over||(this.container.style.transform='translateY('+this.distance+'px)'),!(this.abs>=this.options.threshold))b.classList.remove(this.classThreshold);else if(b.classList.add(this.classThreshold),!this.executed){if(Array.isArray(this.callbacks.threshold)){var e,f=!0,h=!1;try{for(var i,j,k=this.callbacks.threshold[Symbol.iterator]();!(f=(i=k.next()).done);f=!0)j=i.value,/^f/.test('undefined'==typeof j?'undefined':d(j))&&j.apply(this,[this.direction,this])}catch(a){h=!0,e=a}finally{try{!f&&k.return&&k.return()}finally{if(h)throw e}}}this.executed=!0}if(Array.isArray(this.callbacks.pulling)){var l,m=!0,n=!1;try{for(var o,p,q=this.callbacks.pulling[Symbol.iterator]();!(m=(o=q.next()).done);m=!0)p=o.value,/^f/.test('undefined'==typeof p?'undefined':d(p))&&p.apply(this,[this.direction,this.abs,this])}catch(a){n=!0,l=a}finally{try{!m&&q.return&&q.return()}finally{if(n)throw l}}}}}}},{key:'touchend',value:function(){if(!this.isMaxWidth()&&(this.dragging=!1,this.executed=!1,g.classList.remove(this.classPullingUp),g.classList.remove(this.classPullingDown),this.container.style.transform='',this.pullTop.classList.remove(this.classThreshold),this.pullTop.style.height='',this.pullTop.style.opacity='',this.pullBottom.classList.remove(this.classThreshold),this.pullBottom.style.height='',this.pullBottom.style.opacity='',this.abs>=this.options.threshold&&(g.classList.add('down'===this.direction?this.classPulledDown:this.classPulledUp),Array.isArray(this.callbacks.pulled)))){var a,b=!0,c=!1;try{for(var e,f,h=this.callbacks.pulled[Symbol.iterator]();!(b=(e=h.next()).done);b=!0)f=e.value,/^f/.test('undefined'==typeof f?'undefined':d(f))&&f.apply(this,[this.direction,this.abs>=this.options.threshold,this])}catch(b){c=!0,a=b}finally{try{!b&&h.return&&h.return()}finally{if(c)throw a}}}}},{key:'scroll',value:function(){var a=this.canPull;this.isMaxWidth()||('down'===a?(g.classList.add(this.classIsTop),g.classList.remove(this.classIsBottom)):'up'===a?(g.classList.add(this.classIsBottom),g.classList.remove(this.classIsTop)):(g.classList.remove(this.classIsTop),g.classList.remove(this.classIsBottom)))}},{key:'destroy',value:function(){window.removeEventListener('touchstart',this.handlers.touchstart),window.removeEventListener('touchmove',this.handlers.touchmove,!!k&&j),window.removeEventListener('touchend',this.handlers.touchend),window.removeEventListener('resize',this.handlers.scroll),this.container===f||this.container===g?window.removeEventListener('scroll',this.handlers.scroll):this.container.removeEventListener('scroll',this.handlers.scroll),this.style.parentNode.removeChild(this.style)}},{key:'scrollPos',get:function(){var a,b;return this.container===f||this.container===g?(a=window.pageYOffset/(this.container.scrollHeight-window.innerHeight),b=window.innerHeight<this.container.scrollHeight):(a=this.container.scrollTop/(this.container.scrollHeight-this.container.clientHeight),b=this.container.clientHeight<this.container.scrollHeight),!!b&&a}},{key:'canPull',get:function(){var a=!1,b=this.scrollPos;return 0>=b?a='down':1<=b&&(a='up'),!1===b&&(a='both'),a}}]),a}();b.default=l,a.exports=b['default']});