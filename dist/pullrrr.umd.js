/*!
 * pullrrr - version 0.5.0
 *
 * Made with ‚ù§ by Steve Ottoz so@dev.so
 *
 * Copyright (c) 2020 Steve Ottoz
 */
!function(t,s){"object"==typeof exports&&"undefined"!=typeof module?module.exports=s():"function"==typeof define&&define.amd?define(s):(t="undefined"!=typeof globalThis?globalThis:t||self).Pullrrr=s()}(this,(function(){"use strict";function t(s){return(t="function"==typeof Symbol&&"symbol"==typeof Symbol.iterator?function(t){return typeof t}:function(t){return t&&"function"==typeof Symbol&&t.constructor===Symbol&&t!==Symbol.prototype?"symbol":typeof t})(s)}function s(t,s){if(!(t instanceof s))throw new TypeError("Cannot call a class as a function")}function i(t,s){for(var i=0;i<s.length;i++){var o=s[i];o.enumerable=o.enumerable||!1,o.configurable=!0,"value"in o&&(o.writable=!0),Object.defineProperty(t,o.key,o)}}function o(t,s){(null==s||s>t.length)&&(s=t.length);for(var i=0,o=new Array(s);i<s;i++)o[i]=t[i];return o}function n(t,s){var i;if("undefined"==typeof Symbol||null==t[Symbol.iterator]){if(Array.isArray(t)||(i=function(t,s){if(t){if("string"==typeof t)return o(t,s);var i=Object.prototype.toString.call(t).slice(8,-1);return"Object"===i&&t.constructor&&(i=t.constructor.name),"Map"===i||"Set"===i?Array.from(t):"Arguments"===i||/^(?:Ui|I)nt(?:8|16|32)(?:Clamped)?Array$/.test(i)?o(t,s):void 0}}(t))||s&&t&&"number"==typeof t.length){i&&(t=i);var n=0,e=function(){};return{s:e,n:function(){return n>=t.length?{done:!0}:{done:!1,value:t[n++]}},e:function(t){throw t},f:e}}throw new TypeError("Invalid attempt to iterate non-iterable instance.\nIn order to be iterable, non-array objects must have a [Symbol.iterator]() method.")}var l,h=!0,r=!1;return{s:function(){i=t[Symbol.iterator]()},n:function(){var t=i.next();return h=t.done,t},e:function(t){r=!0,l=t},f:function(){try{h||null==i.return||i.return()}finally{if(r)throw l}}}}var e=document.body,l=document.documentElement,h=document.head,r={threshold:100,max:150,prefix:"pullrrr",over:!1,fade:!1,maxWidth:!1,top:!0,bottom:!0},a={passive:!1},c=!1;try{window.addEventListener("test",null,{get passive(){c=!0}})}catch(t){}return function(){function o(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:{};s(this,o),this.options=Object.assign({},r,t),this.dragging=!1,this.startY=null,this.distance=null,this.abs=null,this.direction=null,this.executed=!1,this.callbacks={},this.classContainer="".concat(this.options.prefix,"-container"),this.classPullTop="".concat(this.options.prefix,"-pull-top"),this.classPullBottom="".concat(this.options.prefix,"-pull-bottom"),this.classUseOver="".concat(this.options.prefix,"-use-over"),this.classOver="".concat(this.options.prefix,"-over"),this.classPulledDown="".concat(this.options.prefix,"-pulled-down"),this.classPulledUp="".concat(this.options.prefix,"-pulled-up"),this.classPullingDown="".concat(this.options.prefix,"-pulling-down"),this.classPullingUp="".concat(this.options.prefix,"-pulling-up"),this.classThreshold="".concat(this.options.prefix,"-threshold"),this.classIsTop="".concat(this.options.prefix,"-is-top"),this.classIsBottom="".concat(this.options.prefix,"-is-bottom"),this.styles="\n    /**\n    * Required Pullrrr Styles\n    */\n    .".concat(this.options.prefix,"-container {\n      transition: 0.2s ease-out;\n    }\n    ").concat(this.options.top?"\n    html.".concat(this.options.prefix,"-pulling-down .").concat(this.options.prefix,"-container,\n    html.").concat(this.options.prefix,"-is-top .").concat(this.options.prefix,"-container {\n      touch-action: pan-x pan-down pinch-zoom;\n    }\n    "):"","\n    ").concat(this.options.bottom?"\n    html.".concat(this.options.prefix,"-pulling-up .").concat(this.options.prefix,"-container,\n    html.").concat(this.options.prefix,"-is-bottom .").concat(this.options.prefix,"-container {\n      touch-action: pan-x pan-up pinch-zoom;\n    }\n    "):"","\n    html.").concat(this.options.prefix,"-pulling-up .").concat(this.options.prefix,"-container,\n    html.").concat(this.options.prefix,"-pulling-down .").concat(this.options.prefix,"-container {\n      transition: 0s;\n    }"),this.init()}var p,u,d;return p=o,(u=[{key:"init",value:function(){return(this.options.top||this.options.bottom)&&(this.style=document.createElement("style"),this.style.id="".concat(this.options.prefix,"-styles"),this.options.maxWidth&&!isNaN(this.options.maxWidth)?this.style.textContent="\n        @media (max-width: ".concat(this.options.maxWidth,"px) {\n          ").concat(this.styles,"\n        }\n        "):this.style.textContent=this.styles,h.appendChild(this.style),this.options.container instanceof Node?this.container=this.options.container:"string"==typeof this.options.container?this.container=document.querySelector(this.options.container):this.container=e,this.container.classList.add(this.classContainer),this.options.top&&(this.options.pullTop instanceof Node?this.pullTop=this.options.pullTop:"string"==typeof this.options.pullTop?this.pullTop=document.querySelector(this.options.pullTop):(this.pullTop=document.querySelector(".".concat(this.classPullTop)),this.pullTop||(this.pullTop=document.createElement("div"),this.pullTop.classList.add(this.classPullTop),this.container.appendChild(this.pullTop)))),this.options.bottom&&(this.options.pullBottom instanceof Node?this.pullBottom=this.options.pullBottom:"string"==typeof this.options.pullBottom?this.pullBottom=document.querySelector(this.options.pullBottom):(this.pullBottom=document.querySelector(".".concat(this.classPullBottom)),this.pullBottom||(this.pullBottom=document.createElement("div"),this.pullBottom.classList.add(this.classPullBottom),this.container.appendChild(this.pullBottom)))),this.options.over&&(l.classList.add(this.classUseOver),this.options.top&&this.pullTop.classList.add(this.classOver),this.options.bottom&&this.pullBottom.classList.add(this.classOver)),this.handlers={touchstart:this.touchstart.bind(this),touchmove:this.touchmove.bind(this),touchend:this.touchend.bind(this),scroll:this.scroll.bind(this)},window.addEventListener("touchstart",this.handlers.touchstart),window.addEventListener("touchmove",this.handlers.touchmove,!!c&&a),window.addEventListener("touchend",this.handlers.touchend),window.addEventListener("resize",this.handlers.scroll),this.container===e||this.container===l?window.addEventListener("scroll",this.handlers.scroll):this.container.addEventListener("scroll",this.handlers.scroll),this.scroll()),this}},{key:"on",value:function(t,s){return Array.isArray(this.callbacks[t])||(this.callbacks[t]=[]),this.callbacks[t].push(s),this}},{key:"resist",value:function(){var t=arguments.length>0&&void 0!==arguments[0]?arguments[0]:0,s=Math.min(1,t/this.options.threshold/2.5)*Math.min(this.options.max,t);return t>this.options.max&&(s+=Math.max(0,(t-this.options.max)/6)),s}},{key:"isMaxWidth",value:function(){return this.options.maxWidth&&!isNaN(this.options.maxWidth)&&window.innerWidth>this.options.maxWidth}},{key:"touchstart",value:function(t){this.isMaxWidth()||this.canPull&&(l.classList.remove(this.classPulledUp),l.classList.remove(this.classPulledDown),this.dragging=!0,this.startY=t.touches[0].pageY)}},{key:"touchmove",value:function(s){if(!this.isMaxWidth()&&this.dragging){var i,o=s.touches[0].pageY-this.startY;if(this.direction=this.canPull,this.distance=this.resist(Math.abs(o)),this.abs=this.distance,o<0&&(this.distance=0-this.distance),this.options.top&&("down"===this.direction||"both"===this.direction)&&o>0?(this.direction="down",i=this.pullTop):this.options.bottom&&("up"===this.direction||"both"===this.direction)&&o<0?(this.direction="up",i=this.pullBottom):this.direction=!1,i&&this.direction){if(s.preventDefault(),l.classList.add("down"===this.direction?this.classPullingDown:this.classPullingUp),i.style.height="".concat(this.abs,"px"),this.options.fade&&(i.style.opacity=this.abs/this.options.threshold),this.options.over||(this.container.style.transform="translateY(".concat(this.distance,"px)")),this.abs>=this.options.threshold){if(i.classList.add(this.classThreshold),!this.executed){if(Array.isArray(this.callbacks.threshold)){var e,h=n(this.callbacks.threshold);try{for(h.s();!(e=h.n()).done;){var r=e.value;/^f/.test(t(r))&&r.apply(this,[this.direction,this])}}catch(t){h.e(t)}finally{h.f()}}this.executed=!0}}else i.classList.remove(this.classThreshold);if(Array.isArray(this.callbacks.pulling)){var a,c=n(this.callbacks.pulling);try{for(c.s();!(a=c.n()).done;){var p=a.value;/^f/.test(t(p))&&p.apply(this,[this.direction,this.abs,this])}}catch(t){c.e(t)}finally{c.f()}}}}}},{key:"touchend",value:function(s){if(!this.isMaxWidth()&&(this.dragging=!1,this.executed=!1,l.classList.remove(this.classPullingUp),l.classList.remove(this.classPullingDown),this.container.style.transform="",this.options.top&&(this.pullTop.classList.remove(this.classThreshold),this.pullTop.style.height="",this.pullTop.style.opacity=""),this.options.bottom&&(this.pullBottom.classList.remove(this.classThreshold),this.pullBottom.style.height="",this.pullBottom.style.opacity=""),this.abs>=this.options.threshold&&("down"===this.direction&&this.options.top?l.classList.add(this.classPulledDown):"up"===this.direction&&this.options.bottom&&l.classList.add(this.classPulledUp),Array.isArray(this.callbacks.pulled)&&("down"===this.direction&&this.options.top||"up"===this.direction&&this.options.bottom)))){var i,o=n(this.callbacks.pulled);try{for(o.s();!(i=o.n()).done;){var e=i.value;/^f/.test(t(e))&&e.apply(this,[this.direction,this.abs>=this.options.threshold,this])}}catch(t){o.e(t)}finally{o.f()}}}},{key:"scroll",value:function(t){var s=this.canPull;this.isMaxWidth()||("down"===s?(l.classList.add(this.classIsTop),l.classList.remove(this.classIsBottom)):"up"===s?(l.classList.add(this.classIsBottom),l.classList.remove(this.classIsTop)):(l.classList.remove(this.classIsTop),l.classList.remove(this.classIsBottom)))}},{key:"destroy",value:function(){window.removeEventListener("touchstart",this.handlers.touchstart),window.removeEventListener("touchmove",this.handlers.touchmove,!!c&&a),window.removeEventListener("touchend",this.handlers.touchend),window.removeEventListener("resize",this.handlers.scroll),this.container===e||this.container===l?window.removeEventListener("scroll",this.handlers.scroll):this.container.removeEventListener("scroll",this.handlers.scroll),this.style.parentNode.removeChild(this.style)}},{key:"scrollPos",get:function(){var t,s;return this.container===e||this.container===l?(t=window.pageYOffset/(this.container.scrollHeight-window.innerHeight),s=window.innerHeight<this.container.scrollHeight):(t=this.container.scrollTop/(this.container.scrollHeight-this.container.clientHeight),s=this.container.clientHeight<this.container.scrollHeight),!!s&&t}},{key:"canPull",get:function(){var t=!1,s=this.scrollPos;return s<=0?t="down":s>=1&&(t="up"),!1===s&&(t="both"),t}}])&&i(p.prototype,u),d&&i(p,d),o}()}));
